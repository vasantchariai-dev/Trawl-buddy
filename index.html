<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Food trawl buddy</title>
<style>
  @import url('https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;700&family=Inter:wght@300;400;500;600&display=swap');

  * { margin: 0; padding: 0; box-sizing: border-box; }

  :root {
    --whale-blue: #4A90B8;
    --whale-dark: #2C5F7C;
    --text-dark: #2C3E50;
    --text-mid: #5D6D7E;
    --bg: #FDF6F0;
  }

  body {
    font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
    background: var(--bg);
    color: var(--text-dark);
    min-height: 100vh;
    overflow-x: hidden;
  }

  header {
    text-align: center;
    padding: 2rem 1rem 0.5rem;
  }

  header h1 {
    font-family: 'Playfair Display', Georgia, serif;
    font-size: clamp(2rem, 5vw, 3.2rem);
    font-weight: 700;
    color: var(--text-dark);
    letter-spacing: -0.02em;
  }

  header p {
    font-size: 0.95rem;
    color: var(--text-mid);
    margin-top: 0.3rem;
    font-weight: 300;
  }

  /* ---- Animated hero ---- */
  .hero {
    width: 100%;
    overflow: hidden;
    position: relative;
    height: 160px;
  }

  .whale-strip {
    position: absolute;
    top: 0;
    left: 0;
    width: 3600px;
    height: 100%;
    animation: swim 20s linear infinite;
  }

  .whale-strip svg {
    width: 3600px;
    height: 150px;
  }

  /* The strip is 3600px (two identical 1800px halves).
     Starts shifted left, slides right. A whale at x=100 goes from
     screen -1700 to 100 (entering left, exiting right = swimming right). */
  @keyframes swim {
    from { transform: translateX(-1800px); }
    to   { transform: translateX(0); }
  }

  /* ---- Spinner section ---- */
  .spinner-section {
    display: flex;
    flex-direction: column;
    align-items: center;
    padding: 1rem 1rem 3rem;
  }

  .spinner-container {
    position: relative;
    width: min(85vw, 420px);
    height: min(85vw, 420px);
  }

  .spinner-pointer {
    position: absolute;
    top: -18px;
    left: 50%;
    transform: translateX(-50%);
    z-index: 10;
    filter: drop-shadow(0 2px 4px rgba(0,0,0,0.15));
  }

  canvas#wheel {
    width: 100%;
    height: 100%;
    cursor: pointer;
    border-radius: 50%;
    box-shadow: 0 8px 32px rgba(44, 95, 124, 0.15), 0 2px 8px rgba(0,0,0,0.08);
    transition: box-shadow 0.3s;
  }

  canvas#wheel:hover {
    box-shadow: 0 8px 40px rgba(44, 95, 124, 0.25), 0 2px 12px rgba(0,0,0,0.12);
  }

  .spin-btn {
    margin-top: 1.5rem;
    padding: 0.85rem 2.8rem;
    font-family: 'Inter', sans-serif;
    font-size: 1.05rem;
    font-weight: 600;
    color: #fff;
    background: linear-gradient(135deg, var(--whale-blue), var(--whale-dark));
    border: none;
    border-radius: 50px;
    cursor: pointer;
    box-shadow: 0 4px 16px rgba(44, 95, 124, 0.3);
    transition: transform 0.2s, box-shadow 0.2s;
    letter-spacing: 0.02em;
  }

  .spin-btn:hover {
    transform: translateY(-2px);
    box-shadow: 0 6px 24px rgba(44, 95, 124, 0.4);
  }

  .spin-btn:active { transform: translateY(0); }

  .spin-btn:disabled {
    opacity: 0.6;
    cursor: not-allowed;
    transform: none;
  }

  /* ---- Result display ---- */
  .result {
    margin-top: 1.5rem;
    text-align: center;
    min-height: 3.5rem;
  }

  .result-text {
    font-family: 'Playfair Display', Georgia, serif;
    font-size: clamp(1.4rem, 4vw, 2rem);
    font-weight: 700;
    color: var(--whale-dark);
    opacity: 0;
    transform: translateY(10px);
    transition: opacity 0.5s, transform 0.5s;
  }

  .result-text.show {
    opacity: 1;
    transform: translateY(0);
  }

  .result-sub {
    font-size: 0.85rem;
    color: var(--text-mid);
    margin-top: 0.25rem;
    opacity: 0;
    transition: opacity 0.5s 0.2s;
  }

  .result-sub.show { opacity: 1; }

  footer {
    text-align: center;
    padding: 2rem 1rem;
    font-size: 0.8rem;
    color: var(--text-mid);
    opacity: 0.6;
  }

  @media (max-width: 480px) {
    header { padding: 1.5rem 1rem 0.3rem; }
    .hero { height: 120px; }
    .whale-strip svg { height: 110px; }
    .spinner-section { padding: 0.5rem 1rem 2rem; }
    .spin-btn { padding: 0.75rem 2.2rem; font-size: 1rem; }
  }
</style>
</head>
<body>

<header>
  <h1>Food trawl buddy</h1>
  <p>Spin the wheel, find your feast</p>
</header>

<!-- Hero: three whales swimming right, chasing fish -->
<div class="hero">
  <div class="whale-strip">
    <svg viewBox="0 0 3600 150" xmlns="http://www.w3.org/2000/svg" role="img" aria-label="Three whales trawling fish">
      <defs>
        <linearGradient id="wg1" x1="0" y1="0" x2="1" y2="1">
          <stop offset="0%" stop-color="#5DADE2"/>
          <stop offset="100%" stop-color="#2C5F7C"/>
        </linearGradient>
        <linearGradient id="wg2" x1="0" y1="0" x2="1" y2="1">
          <stop offset="0%" stop-color="#76C7E8"/>
          <stop offset="100%" stop-color="#3A7CA5"/>
        </linearGradient>
        <linearGradient id="wg3" x1="0" y1="0" x2="1" y2="1">
          <stop offset="0%" stop-color="#6BC0D4"/>
          <stop offset="100%" stop-color="#2E7A91"/>
        </linearGradient>
      </defs>

      <!-- ===== SET 1 (positions 0‚Äì1800) ===== -->

      <!-- Whale 1 (big) -->
      <g transform="translate(80, 15)" fill="url(#wg1)">
        <path d="M 0,50 Q 8,12 48,6 Q 72,0 96,5 Q 120,11 136,26 L 148,40 L 148,62 L 136,76 Q 120,92 96,97 Q 72,101 48,95 Q 8,86 0,50 Z"/>
        <path d="M 136,26 L 162,32 L 162,38 L 148,40 Z"/>
        <path d="M 148,62 L 162,66 L 162,72 L 136,76 Z"/>
        <path d="M 148,40 L 162,38 L 162,66 L 148,62 Z" fill="#1A3A4F" opacity="0.45"/>
        <path d="M 0,50 Q -12,32 -24,20 Q -16,36 -20,50 Q -16,64 -24,80 Q -12,68 0,50 Z"/>
        <circle cx="116" cy="36" r="4" fill="#1A3A4F"/><circle cx="117" cy="35" r="1.2" fill="#fff"/>
        <path d="M 64,95 Q 72,115 56,122 Q 52,110 64,95 Z" opacity="0.6"/>
        <line x1="48" y1="66" x2="110" y2="64" stroke="#fff" stroke-width="0.6" opacity="0.15"/>
        <line x1="44" y1="74" x2="106" y2="72" stroke="#fff" stroke-width="0.6" opacity="0.15"/>
        <line x1="48" y1="82" x2="98" y2="80" stroke="#fff" stroke-width="0.6" opacity="0.15"/>
      </g>
      <!-- Fish ahead of whale 1 -->
      <g fill="#F5B041"><ellipse cx="258" cy="58" rx="7" ry="3.5"/><polygon points="265,57 271,53 271,63 265,59"/><circle cx="254" cy="57" r="0.8" fill="#2C3E50"/></g>
      <g fill="#E8B960"><ellipse cx="272" cy="46" rx="6" ry="3"/><polygon points="278,45 283,42 283,50 278,47"/><circle cx="268" cy="45" r="0.7" fill="#2C3E50"/></g>
      <g fill="#F0C36D"><ellipse cx="265" cy="70" rx="5.5" ry="2.8"/><polygon points="270,69 275,66 275,74 270,71"/><circle cx="262" cy="69" r="0.6" fill="#2C3E50"/></g>
      <g fill="#F5B041"><ellipse cx="285" cy="54" rx="5" ry="2.5"/><polygon points="290,53 294,50 294,58 290,55"/><circle cx="282" cy="53" r="0.6" fill="#2C3E50"/></g>
      <circle cx="252" cy="30" r="2" fill="#AED6F1" opacity="0.3"/>
      <circle cx="260" cy="22" r="1.3" fill="#AED6F1" opacity="0.25"/>

      <!-- Whale 2 (medium) -->
      <g transform="translate(550, 25)" fill="url(#wg2)">
        <path d="M 0,50 Q 8,12 48,6 Q 72,0 96,5 Q 120,11 136,26 L 148,40 L 148,62 L 136,76 Q 120,92 96,97 Q 72,101 48,95 Q 8,86 0,50 Z"/>
        <path d="M 136,26 L 162,32 L 162,38 L 148,40 Z"/>
        <path d="M 148,62 L 162,66 L 162,72 L 136,76 Z"/>
        <path d="M 148,40 L 162,38 L 162,66 L 148,62 Z" fill="#1A3A4F" opacity="0.45"/>
        <path d="M 0,50 Q -12,32 -24,20 Q -16,36 -20,50 Q -16,64 -24,80 Q -12,68 0,50 Z"/>
        <circle cx="116" cy="36" r="4" fill="#1A3A4F"/><circle cx="117" cy="35" r="1.2" fill="#fff"/>
        <path d="M 64,95 Q 72,115 56,122 Q 52,110 64,95 Z" opacity="0.6"/>
        <line x1="48" y1="66" x2="110" y2="64" stroke="#fff" stroke-width="0.6" opacity="0.15"/>
        <line x1="44" y1="74" x2="106" y2="72" stroke="#fff" stroke-width="0.6" opacity="0.15"/>
      </g>
      <!-- Fish ahead of whale 2 -->
      <g fill="#E8B960"><ellipse cx="728" cy="68" rx="6" ry="3"/><polygon points="734,67 739,64 739,72 734,69"/><circle cx="724" cy="67" r="0.7" fill="#2C3E50"/></g>
      <g fill="#F0C36D"><ellipse cx="740" cy="56" rx="5.5" ry="2.8"/><polygon points="745,55 750,52 750,60 745,57"/><circle cx="737" cy="55" r="0.6" fill="#2C3E50"/></g>
      <g fill="#F5B041"><ellipse cx="735" cy="80" rx="5" ry="2.5"/><polygon points="740,79 744,76 744,84 740,81"/><circle cx="732" cy="79" r="0.6" fill="#2C3E50"/></g>
      <circle cx="725" cy="40" r="1.8" fill="#AED6F1" opacity="0.3"/>

      <!-- Whale 3 (smaller) -->
      <g transform="translate(1100, 30) scale(0.85)" fill="url(#wg3)">
        <path d="M 0,50 Q 8,12 48,6 Q 72,0 96,5 Q 120,11 136,26 L 148,40 L 148,62 L 136,76 Q 120,92 96,97 Q 72,101 48,95 Q 8,86 0,50 Z"/>
        <path d="M 136,26 L 162,32 L 162,38 L 148,40 Z"/>
        <path d="M 148,62 L 162,66 L 162,72 L 136,76 Z"/>
        <path d="M 148,40 L 162,38 L 162,66 L 148,62 Z" fill="#1A3A4F" opacity="0.45"/>
        <path d="M 0,50 Q -12,32 -24,20 Q -16,36 -20,50 Q -16,64 -24,80 Q -12,68 0,50 Z"/>
        <circle cx="116" cy="36" r="4" fill="#1A3A4F"/><circle cx="117" cy="35" r="1.2" fill="#fff"/>
        <path d="M 64,95 Q 72,115 56,122 Q 52,110 64,95 Z" opacity="0.6"/>
        <line x1="48" y1="66" x2="110" y2="64" stroke="#fff" stroke-width="0.6" opacity="0.15"/>
      </g>
      <!-- Fish ahead of whale 3 -->
      <g fill="#F5B041"><ellipse cx="1248" cy="62" rx="6" ry="3"/><polygon points="1254,61 1259,58 1259,66 1254,63"/><circle cx="1244" cy="61" r="0.7" fill="#2C3E50"/></g>
      <g fill="#E8B960"><ellipse cx="1258" cy="50" rx="5" ry="2.5"/><polygon points="1263,49 1267,46 1267,54 1263,51"/><circle cx="1255" cy="49" r="0.6" fill="#2C3E50"/></g>
      <circle cx="1242" cy="38" r="1.5" fill="#AED6F1" opacity="0.3"/>

      <!-- Loose fish -->
      <g fill="#F0C36D"><ellipse cx="420" cy="45" rx="5" ry="2.5"/><polygon points="425,44 429,41 429,49 425,46"/><circle cx="417" cy="44" r="0.6" fill="#2C3E50"/></g>
      <g fill="#E8B960"><ellipse cx="920" cy="50" rx="5.5" ry="2.8"/><polygon points="925,49 930,46 930,54 925,51"/><circle cx="917" cy="49" r="0.6" fill="#2C3E50"/></g>
      <g fill="#F5B041"><ellipse cx="1500" cy="55" rx="5" ry="2.5"/><polygon points="1505,54 1509,51 1509,59 1505,56"/><circle cx="1497" cy="54" r="0.6" fill="#2C3E50"/></g>
      <g fill="#F0C36D"><ellipse cx="1620" cy="42" rx="5.5" ry="2.8"/><polygon points="1625,41 1630,38 1630,46 1625,43"/><circle cx="1617" cy="41" r="0.6" fill="#2C3E50"/></g>

      <!-- ===== SET 2 (exact duplicate at +1800) ===== -->

      <g transform="translate(1880, 15)" fill="url(#wg1)">
        <path d="M 0,50 Q 8,12 48,6 Q 72,0 96,5 Q 120,11 136,26 L 148,40 L 148,62 L 136,76 Q 120,92 96,97 Q 72,101 48,95 Q 8,86 0,50 Z"/>
        <path d="M 136,26 L 162,32 L 162,38 L 148,40 Z"/>
        <path d="M 148,62 L 162,66 L 162,72 L 136,76 Z"/>
        <path d="M 148,40 L 162,38 L 162,66 L 148,62 Z" fill="#1A3A4F" opacity="0.45"/>
        <path d="M 0,50 Q -12,32 -24,20 Q -16,36 -20,50 Q -16,64 -24,80 Q -12,68 0,50 Z"/>
        <circle cx="116" cy="36" r="4" fill="#1A3A4F"/><circle cx="117" cy="35" r="1.2" fill="#fff"/>
        <path d="M 64,95 Q 72,115 56,122 Q 52,110 64,95 Z" opacity="0.6"/>
        <line x1="48" y1="66" x2="110" y2="64" stroke="#fff" stroke-width="0.6" opacity="0.15"/>
        <line x1="44" y1="74" x2="106" y2="72" stroke="#fff" stroke-width="0.6" opacity="0.15"/>
        <line x1="48" y1="82" x2="98" y2="80" stroke="#fff" stroke-width="0.6" opacity="0.15"/>
      </g>
      <g fill="#F5B041"><ellipse cx="2058" cy="58" rx="7" ry="3.5"/><polygon points="2065,57 2071,53 2071,63 2065,59"/><circle cx="2054" cy="57" r="0.8" fill="#2C3E50"/></g>
      <g fill="#E8B960"><ellipse cx="2072" cy="46" rx="6" ry="3"/><polygon points="2078,45 2083,42 2083,50 2078,47"/><circle cx="2068" cy="45" r="0.7" fill="#2C3E50"/></g>
      <g fill="#F0C36D"><ellipse cx="2065" cy="70" rx="5.5" ry="2.8"/><polygon points="2070,69 2075,66 2075,74 2070,71"/><circle cx="2062" cy="69" r="0.6" fill="#2C3E50"/></g>
      <g fill="#F5B041"><ellipse cx="2085" cy="54" rx="5" ry="2.5"/><polygon points="2090,53 2094,50 2094,58 2090,55"/><circle cx="2082" cy="53" r="0.6" fill="#2C3E50"/></g>
      <circle cx="2052" cy="30" r="2" fill="#AED6F1" opacity="0.3"/>
      <circle cx="2060" cy="22" r="1.3" fill="#AED6F1" opacity="0.25"/>

      <g transform="translate(2350, 25)" fill="url(#wg2)">
        <path d="M 0,50 Q 8,12 48,6 Q 72,0 96,5 Q 120,11 136,26 L 148,40 L 148,62 L 136,76 Q 120,92 96,97 Q 72,101 48,95 Q 8,86 0,50 Z"/>
        <path d="M 136,26 L 162,32 L 162,38 L 148,40 Z"/>
        <path d="M 148,62 L 162,66 L 162,72 L 136,76 Z"/>
        <path d="M 148,40 L 162,38 L 162,66 L 148,62 Z" fill="#1A3A4F" opacity="0.45"/>
        <path d="M 0,50 Q -12,32 -24,20 Q -16,36 -20,50 Q -16,64 -24,80 Q -12,68 0,50 Z"/>
        <circle cx="116" cy="36" r="4" fill="#1A3A4F"/><circle cx="117" cy="35" r="1.2" fill="#fff"/>
        <path d="M 64,95 Q 72,115 56,122 Q 52,110 64,95 Z" opacity="0.6"/>
        <line x1="48" y1="66" x2="110" y2="64" stroke="#fff" stroke-width="0.6" opacity="0.15"/>
        <line x1="44" y1="74" x2="106" y2="72" stroke="#fff" stroke-width="0.6" opacity="0.15"/>
      </g>
      <g fill="#E8B960"><ellipse cx="2528" cy="68" rx="6" ry="3"/><polygon points="2534,67 2539,64 2539,72 2534,69"/><circle cx="2524" cy="67" r="0.7" fill="#2C3E50"/></g>
      <g fill="#F0C36D"><ellipse cx="2540" cy="56" rx="5.5" ry="2.8"/><polygon points="2545,55 2550,52 2550,60 2545,57"/><circle cx="2537" cy="55" r="0.6" fill="#2C3E50"/></g>
      <g fill="#F5B041"><ellipse cx="2535" cy="80" rx="5" ry="2.5"/><polygon points="2540,79 2544,76 2544,84 2540,81"/><circle cx="2532" cy="79" r="0.6" fill="#2C3E50"/></g>
      <circle cx="2525" cy="40" r="1.8" fill="#AED6F1" opacity="0.3"/>

      <g transform="translate(2900, 30) scale(0.85)" fill="url(#wg3)">
        <path d="M 0,50 Q 8,12 48,6 Q 72,0 96,5 Q 120,11 136,26 L 148,40 L 148,62 L 136,76 Q 120,92 96,97 Q 72,101 48,95 Q 8,86 0,50 Z"/>
        <path d="M 136,26 L 162,32 L 162,38 L 148,40 Z"/>
        <path d="M 148,62 L 162,66 L 162,72 L 136,76 Z"/>
        <path d="M 148,40 L 162,38 L 162,66 L 148,62 Z" fill="#1A3A4F" opacity="0.45"/>
        <path d="M 0,50 Q -12,32 -24,20 Q -16,36 -20,50 Q -16,64 -24,80 Q -12,68 0,50 Z"/>
        <circle cx="116" cy="36" r="4" fill="#1A3A4F"/><circle cx="117" cy="35" r="1.2" fill="#fff"/>
        <path d="M 64,95 Q 72,115 56,122 Q 52,110 64,95 Z" opacity="0.6"/>
        <line x1="48" y1="66" x2="110" y2="64" stroke="#fff" stroke-width="0.6" opacity="0.15"/>
      </g>
      <g fill="#F5B041"><ellipse cx="3048" cy="62" rx="6" ry="3"/><polygon points="3054,61 3059,58 3059,66 3054,63"/><circle cx="3044" cy="61" r="0.7" fill="#2C3E50"/></g>
      <g fill="#E8B960"><ellipse cx="3058" cy="50" rx="5" ry="2.5"/><polygon points="3063,49 3067,46 3067,54 3063,51"/><circle cx="3055" cy="49" r="0.6" fill="#2C3E50"/></g>
      <circle cx="3042" cy="38" r="1.5" fill="#AED6F1" opacity="0.3"/>

      <g fill="#F0C36D"><ellipse cx="2220" cy="45" rx="5" ry="2.5"/><polygon points="2225,44 2229,41 2229,49 2225,46"/><circle cx="2217" cy="44" r="0.6" fill="#2C3E50"/></g>
      <g fill="#E8B960"><ellipse cx="2720" cy="50" rx="5.5" ry="2.8"/><polygon points="2725,49 2730,46 2730,54 2725,51"/><circle cx="2717" cy="49" r="0.6" fill="#2C3E50"/></g>
      <g fill="#F5B041"><ellipse cx="3300" cy="55" rx="5" ry="2.5"/><polygon points="3305,54 3309,51 3309,59 3305,56"/><circle cx="3297" cy="54" r="0.6" fill="#2C3E50"/></g>
      <g fill="#F0C36D"><ellipse cx="3420" cy="42" rx="5.5" ry="2.8"/><polygon points="3425,41 3430,38 3430,46 3425,43"/><circle cx="3417" cy="41" r="0.6" fill="#2C3E50"/></g>
    </svg>
  </div>
</div>

<!-- Spinner -->
<section class="spinner-section">
  <div class="spinner-container">
    <svg class="spinner-pointer" width="36" height="28" viewBox="0 0 36 28">
      <polygon points="18,28 4,0 32,0" fill="var(--whale-dark)" stroke="#fff" stroke-width="1.5"/>
    </svg>
    <canvas id="wheel" width="840" height="840"></canvas>
  </div>

  <button class="spin-btn" id="spinBtn" onclick="spin()">Spin the wheel</button>

  <div class="result">
    <div class="result-text" id="resultText"></div>
    <div class="result-sub" id="resultSub"></div>
  </div>
</section>

<footer>
  Made with appetite &mdash; Food trawl buddy
</footer>

<script>
(function () {
  // ---- Food options ----
  const options = [
    { label: 'P√∏lser',                    emoji: 'üå≠', color: '#FADBD8' },
    { label: 'Burgers',                   emoji: 'üçî', color: '#FDDCB5' },
    { label: 'Itty bitty Swedish things', emoji: 'üá∏üá™', color: '#D6EAF8' },
    { label: 'Sourdough pancakes',        emoji: 'ü•û', color: '#D4EDDA' },
    { label: 'Slow-cooker!',              emoji: 'üç≤', color: '#E8DAEF' },
    { label: 'All you can eat brunch',    emoji: 'ü•Ç', color: '#FEF9E7' },
    { label: 'Sm√∏rrebr√∏d',                emoji: 'üçû', color: '#D5E8D4' },
  ];

  const subtitles = {
    'P√∏lser':                    'Danish hotdogs ‚Äî r√∏d p√∏lse!',
    'Burgers':                   'Obviously',
    'Itty bitty Swedish things': 'Sm√• r√§tter, stor gl√§dje',
    'Sourdough pancakes':        'Fermented & fluffy',
    'Slow-cooker!':              'Set it and forget it',
    'All you can eat brunch':    'No limits, no regrets',
    'Sm√∏rrebr√∏d':                'Danish open sandwiches',
  };

  const n = options.length;
  const arc = (2 * Math.PI) / n;

  const canvas = document.getElementById('wheel');
  const ctx = canvas.getContext('2d');
  const size = canvas.width;
  const cx = size / 2;
  const cy = size / 2;
  const radius = cx - 10;

  let currentAngle = 0;
  let spinning = false;

  function draw() {
    ctx.clearRect(0, 0, size, size);

    ctx.save();
    ctx.beginPath();
    ctx.arc(cx, cy, radius + 4, 0, 2 * Math.PI);
    ctx.fillStyle = 'rgba(44, 95, 124, 0.08)';
    ctx.fill();
    ctx.restore();

    for (let i = 0; i < n; i++) {
      const startAngle = currentAngle + i * arc - Math.PI / 2;
      const endAngle = startAngle + arc;

      ctx.beginPath();
      ctx.moveTo(cx, cy);
      ctx.arc(cx, cy, radius, startAngle, endAngle);
      ctx.closePath();
      ctx.fillStyle = options[i].color;
      ctx.fill();
      ctx.strokeStyle = '#fff';
      ctx.lineWidth = 3;
      ctx.stroke();

      // Label
      ctx.save();
      ctx.translate(cx, cy);
      ctx.rotate(startAngle + arc / 2);
      ctx.textAlign = 'right';
      ctx.fillStyle = '#2C3E50';

      // Shrink font for longer labels
      const label = options[i].label;
      const fontSize = label.length > 16 ? 20 : label.length > 10 ? 24 : 28;
      ctx.font = 'bold ' + fontSize + 'px Inter, sans-serif';
      ctx.fillText(label, radius - 50, 4);

      ctx.font = '32px sans-serif';
      ctx.fillText(options[i].emoji, radius - 14, 6);
      ctx.restore();
    }

    // Centre circle
    ctx.beginPath();
    ctx.arc(cx, cy, 44, 0, 2 * Math.PI);
    ctx.fillStyle = '#fff';
    ctx.fill();
    ctx.strokeStyle = '#E8DAEF';
    ctx.lineWidth = 3;
    ctx.stroke();

    ctx.beginPath();
    ctx.arc(cx, cy, 38, 0, 2 * Math.PI);
    const cg = ctx.createRadialGradient(cx, cy, 5, cx, cy, 38);
    cg.addColorStop(0, '#5DADE2');
    cg.addColorStop(1, '#2C5F7C');
    ctx.fillStyle = cg;
    ctx.fill();

    ctx.fillStyle = '#fff';
    ctx.font = '28px sans-serif';
    ctx.textAlign = 'center';
    ctx.textBaseline = 'middle';
    ctx.fillText('üç¥', cx, cy + 1);

    ctx.beginPath();
    ctx.arc(cx, cy, radius, 0, 2 * Math.PI);
    ctx.strokeStyle = 'rgba(44, 95, 124, 0.12)';
    ctx.lineWidth = 5;
    ctx.stroke();
  }

  draw();

  // ---- Audio ----
  let audioCtx = null;
  function playDing() {
    try {
      if (!audioCtx) audioCtx = new (window.AudioContext || window.webkitAudioContext)();
      const osc = audioCtx.createOscillator();
      const gain = audioCtx.createGain();
      osc.connect(gain);
      gain.connect(audioCtx.destination);
      osc.type = 'sine';
      osc.frequency.setValueAtTime(880, audioCtx.currentTime);
      osc.frequency.exponentialRampToValueAtTime(440, audioCtx.currentTime + 0.3);
      gain.gain.setValueAtTime(0.3, audioCtx.currentTime);
      gain.gain.exponentialRampToValueAtTime(0.001, audioCtx.currentTime + 0.5);
      osc.start(audioCtx.currentTime);
      osc.stop(audioCtx.currentTime + 0.5);
    } catch (e) {}
  }

  function playTick() {
    try {
      if (!audioCtx) audioCtx = new (window.AudioContext || window.webkitAudioContext)();
      const osc = audioCtx.createOscillator();
      const gain = audioCtx.createGain();
      osc.connect(gain);
      gain.connect(audioCtx.destination);
      osc.type = 'sine';
      osc.frequency.setValueAtTime(1200, audioCtx.currentTime);
      gain.gain.setValueAtTime(0.06, audioCtx.currentTime);
      gain.gain.exponentialRampToValueAtTime(0.001, audioCtx.currentTime + 0.04);
      osc.start(audioCtx.currentTime);
      osc.stop(audioCtx.currentTime + 0.04);
    } catch (e) {}
  }

  // ---- Spin logic ----
  window.spin = function () {
    if (spinning) return;
    spinning = true;

    const btn = document.getElementById('spinBtn');
    btn.disabled = true;
    btn.textContent = 'Spinning...';

    const rt = document.getElementById('resultText');
    const rs = document.getElementById('resultSub');
    rt.classList.remove('show');
    rs.classList.remove('show');

    const totalRotation = (5 + Math.random() * 4) * 2 * Math.PI + Math.random() * 2 * Math.PI;
    const duration = 4000 + Math.random() * 1500;
    const startAngle = currentAngle;
    const startTime = performance.now();

    let lastSegment = -1;

    function animate(now) {
      const elapsed = now - startTime;
      const progress = Math.min(elapsed / duration, 1);
      const eased = 1 - Math.pow(1 - progress, 3);
      currentAngle = startAngle + totalRotation * eased;

      draw();

      const normalised = ((currentAngle % (2 * Math.PI)) + 2 * Math.PI) % (2 * Math.PI);
      const currentSeg = Math.floor(normalised / arc);
      if (currentSeg !== lastSegment) {
        lastSegment = currentSeg;
        if (progress < 0.95) playTick();
      }

      if (progress < 1) {
        requestAnimationFrame(animate);
      } else {
        const finalAngle = ((currentAngle % (2 * Math.PI)) + 2 * Math.PI) % (2 * Math.PI);
        const pointerInWheel = ((2 * Math.PI - finalAngle) % (2 * Math.PI) + 2 * Math.PI) % (2 * Math.PI);
        const winnerIndex = Math.floor(pointerInWheel / arc) % n;

        playDing();

        rt.textContent = options[winnerIndex].emoji + ' ' + options[winnerIndex].label;
        rs.textContent = subtitles[options[winnerIndex].label];

        setTimeout(() => { rt.classList.add('show'); }, 100);
        setTimeout(() => { rs.classList.add('show'); }, 300);

        btn.disabled = false;
        btn.textContent = 'Spin again';
        spinning = false;
      }
    }

    requestAnimationFrame(animate);
  };

  canvas.addEventListener('click', function () {
    if (!spinning) window.spin();
  });
})();
</script>

<script>
if ('serviceWorker' in navigator) {
  navigator.serviceWorker.register('sw.js').catch(function () {});
}
</script>

</body>
</html>
